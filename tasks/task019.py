import re;p=lambda g,k=7:-k*g or p(eval(re.sub('0(?=.{%d}[1-79])'%(len(g)*3*2**(h:=k>5)+4),'8',str([*zip(*g+g*h)][::-1]))),k-1)