def p(e):o,o=len(e),len(e[0]);return max((sum(l:=sum((r[1:-1]for r in r[1:-1]),[])),[[r and max(l)for r in r]for r in r])for i in range(o)for b in range(o)for t in range(i+3,o+1)for a in range(b+3,o+1)if all((r:=[r[b:a]for r in e[i:t]])[0]+r[-1]+[r[i]for r in r for i in(0,-1)]))[1]