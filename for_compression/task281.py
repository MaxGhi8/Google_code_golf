def p(n,d=1):
 for f in' '*4:
  n=[*zip(*n)][::-1]
  if d and{*sum(n[(m:=sum(n,()).index(8)//len(n[0])):],())}=={0,8}:
   for m in range(max(m for m in range(m)if sum(n[m])),m):n[m:m+2]=n[m-1:m+1];d=0
 return n