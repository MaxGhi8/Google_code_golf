def e(e):a,y=zip(*((a,y)for y,e in enumerate(e)for a,e in enumerate(e)if e));p,a,y=max(max(y)-min(y),max(a)-min(a))>>1,sum(a)>>2,sum(y)>>2;return[e[a-p:a-~p]for e in e[y-p:y-~p]]
def p(g):x=max(o:=sum(g,[]),key=o.count);return[[sum(p)or x for p in zip(*e)]for e in zip(*(e([[e*(e==k)for e in e]for e in g])for k in {*o}^{x}))]