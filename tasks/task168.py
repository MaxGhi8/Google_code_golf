import re;p=lambda g,k=27:-k*g or p(eval(re.sub('([^0]{6}.{28} ([^0]).{25}(.{29})*)0',r'\1\2',str([*zip(*g[::-1])]))),k-1)