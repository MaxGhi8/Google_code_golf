p=lambda g,k=15:-k*g or p([[[v>0and v-(x==2),(x==6)+v,{v:v,-4:6,-2:0}[v],v-(v!=1)*(x*w==1)][k//4]for v,x,w in zip(r,[0]+r,r[1:]+[0])]for*r,in zip(*g[::-1])],k-1)