p=lambda d,t=-43:d*(t-12)or p([[[[[c,9][t>11>c==2],8][t>1==c<a>7],2][a==2<c>8]for a,c in zip([2]+r,r)]for*r,in zip(*d[::-1])],t+1)