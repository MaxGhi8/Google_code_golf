p=lambda g:next([[g[p][z]or t[(p-z)%n,(z-f)%n]for z in range(29)]for p in range(29)]for n in range(29) for n in(*range(29),29)for z in range(29)[:n]for f in range(29)[:n]if(t:={})or all(((a:=g[p][z])and t.setdefault(((p-z)%n,(z-f)%n),a)==a)or(1-f and a<1)or f and((p-z)%n,(z-f)%n)in t for f in(0,1)for p in range(29) for z in range(29)))