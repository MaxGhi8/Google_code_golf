f=lambda g:[[v or max({*r[:j+1]}&{*r[j:]})for j,v in enumerate(r)]for r in zip(*g)];p=lambda g:f(f(g))