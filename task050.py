def p(g,k=0):g=[[(8in{*r[:i]}&{*r[i+1:]})*3+r[i]for i,v in enumerate(r)]for r in[[*c]for c in zip(*g)]];return g if k else p(g,1)