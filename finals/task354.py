p=lambda g,k=15:-k*g or p([[(x and r[-1]or x,[x,v or x][x==5])[k<15]for x,v in zip(r,[0]+r)]for*r,in zip(*g[::-1])],k-1)
