def p(g,e=enumerate):
 for _ in 0,0:
  *g,=map(list,zip(*g))
  for i,r in e(g*(len({*g[0],0})>2)):
   for j,v in e(r):r[j]=[v,0][0in r and v in[*zip(*g[i-3:])][r.index(0)]]
 return g