p=lambda g:[[(k:=min(s:=sum(g,[]),key=s.count))*(k in(r[0],v))for v in g[0]]for r in g]