p=lambda g,f=lambda d:[*filter(any,zip(*d))]:f(f([[v*(v==max({*(s:=sum(g,[]))}-{0},key=s.count))for v in r]for r in g]))