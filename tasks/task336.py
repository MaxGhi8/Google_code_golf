p=lambda g,k=23:-k*g or p([*zip(*[[r[j]or(5in r[:j])*8*(5in r[j:]or r[j-1]>5)for j in range(10)]for r in g[::-1]])],k-1)