p=lambda g:sum(3in r for r in g)>1and sorted(g[-2:],reverse=3in g[0])+g[:-2]or[*zip(*p([*zip(*g)]))]