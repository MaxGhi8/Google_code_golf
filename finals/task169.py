p=lambda d,t=23,l=0:-t*d or p([[[[(h:=a>0)*b|a,1<<(l:=l+1)][a%2],5*h-a.bit_count()][t<1]for a,b in zip(r,r[1:]+[0])]for*r,in zip(*d[::-1])],t-1)