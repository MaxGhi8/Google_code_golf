import re;p=lambda g,k=23,x='(?<=[24]..)[13-9]':-k*g or p(eval(re.sub(f'(?<=[24].{{{len(g)*3+1}}}){x}|{x}(?=..[24])','4',str([*zip(*g)][::-1]))),k-1)