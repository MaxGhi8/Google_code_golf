def p(g,R=range(-9,9),z=[[0]*10],S=sum,Z=zip,M=max):
 for _ in" "*3:g=M((S(S(map(lambda w:0<w[0]==w[1],Z(*r)))for r in Z(g,K)),(m:=[[*map(M,Z(*r))]for r in Z(g,K)])[::(-1)**({*S(g,[])}=={0,3})],m)for K in[z*y+[[0]*x+[*r[M(-x,0):]]+[0]*9for r in[*Z(*g[::-1])][M(-y,0):]]+z*9for x in R for y in R])[2]
 return g
