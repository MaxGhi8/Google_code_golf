p=lambda d,t=11,l=0:-t*d or p([[[[b*(b!=5!=a)|a,1<<(l:=l+1)][a<1],5+~a.bit_count()*(a!=5)][t<1]for a,b in zip(r,[0]+r)]for*r,in zip(*d[::-1])],t-1)