p=lambda d,t=-43:d*(t-8)or p([[[[[c,0][t>7>c==2],3][t>1==c>a%3],2][a==2>c<1]for a,c in zip([2]+r,r)]for*r,in zip(*d[::-1])],t+1)