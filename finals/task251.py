p=lambda g,k=31:-k*g or p([[[[x,2*(x>1)][v<1],x or 1][k>30]for x,v in zip(r,[0]+r)]for*r,in zip(*g[::-1])],k-1)