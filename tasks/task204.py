p=lambda g,k=3:-k*g or p([r.count(1)>1and((i:=r.index(1)),(d:=~i+r.index(1,i+1)),r[:i+1]+(2|d%2*5,)*d+r[i+d+1:])[-1]or r for r in zip(*g[::-1])],k-1)